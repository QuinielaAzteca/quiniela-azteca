<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Quiniela Azteca ‚Äì Monitor</title>

<style>
:root{
  --fg:#0f172a;
  --muted:#475569;
  --bg:#eaf3ee;
  --bg2:#dfeee7;
  --line:#d7e6dc;
  --l:#0a6b3a;
  --v:#c62828;

  --wFolio:22px;
  --wNombre:200px;
  --wSel:20px;
  --wA:24px;
}

*{box-sizing:border-box}
html,body{height:100%;overflow:hidden}

body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:radial-gradient(1200px 520px at 50% -140px,#fff 0%,var(--bg) 55%,var(--bg2) 100%);
  display:flex;
  flex-direction:column;
}

/* HEADER */
.header{
  position:sticky;
  top:0;
  z-index:50;
  background:#fff;
  border-bottom:1px solid var(--line);
}
.header-inner{max-width:1100px;margin:auto;padding:8px 10px}
.title{font-weight:1000;font-size:18px}
.title .mxg{color:var(--l)}
.title .mxr{color:var(--v)}
.week{font-size:12px;font-weight:800;color:var(--muted)}

/* PARTIDOS */
.partidos{margin-top:6px;font-size:10px;font-weight:900}
.p{display:flex;justify-content:space-between;padding:3px 6px;border-radius:8px;border:1px solid var(--line)}
.p:nth-child(even){background:#f6fbf8}
.chip{padding:2px 6px;border-radius:999px;border:1px solid #e5e7eb}

/* SEARCH */
.search{margin-top:6px;position:relative}
.search::before{content:"üîç";position:absolute;left:10px;top:50%;transform:translateY(-50%)}
.search input{
  width:100%;
  padding:8px 10px 8px 36px;
  font-size:14px;
  font-weight:900;
  border:2px solid #cbd5e1;
  border-radius:14px;
}

/* HEAD */
.tableHeadRow{
  margin-top:6px;
  border:1px solid var(--line);
  border-radius:12px;
  overflow:hidden;
}
.tableHeadGrid{
  display:grid;
  grid-template-columns:var(--wFolio) var(--wNombre) repeat(9,var(--wSel)) var(--wA);
}
.thCell{
  padding:6px 4px;
  font-size:11px;
  font-weight:1000;
  border-right:1px solid var(--line);
  text-align:center;
}
.thCell.left{text-align:left}
.thCell:last-child{border-right:none}

/* WRAP */
.wrap{
  flex:1;
  min-height:0;
  max-width:1100px;
  margin:auto;
  padding:10px 12px;
  overflow:hidden;
}

/* TABLE */
.tableBox{
  height:100%;
  overflow:auto;
  border:1px solid var(--line);
  border-radius:14px;
  background:#fff;
  overscroll-behavior:contain;
}
.tableBox::after{
  content:"";
  display:block;
  height:calc(80px + env(safe-area-inset-bottom));
}

table{width:100%;table-layout:fixed;border-collapse:separate;border-spacing:0}
td{
  padding:4px;
  border-bottom:1px solid var(--line);
  font-weight:900;
  text-align:center;
}
td.col-folio{width:var(--wFolio);font-size:7px;text-align:right}
td.col-nombre{
  width:var(--wNombre);
  text-align:left;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
td.col-ac{width:var(--wA)}

.selCell{width:var(--wSel)}
.selPill{
  display:inline-flex;
  align-items:center;
  justify-content:center;

  /* ‚úÖ la pastilla siempre cabe dentro de la columna */
  width: calc(var(--wSel) - 2px);
  height: calc(var(--wSel) + 2px);

  border-radius:12px;
  border:1px solid var(--pillBorder);
  font-weight:900;
  font-size:12px;
  line-height:1;
  background:#fff;
}

/* NO RESULTS */
.noResults{
  padding:20px;
  text-align:center;
  font-weight:1000;
  color:#0f172a;
}
</style>
  /* ===== AJUSTE SOLO PARA M√ìVILES ===== */
@media (max-width:520px){
  :root{
    --wNombre: 150px;
    --wSel: 16px;
    --wA: 22px;
  }
  .selPill{
    font-size:11px;
    border-radius:11px;
  }
}

@media (max-width:420px){
  :root{
    --wNombre: 130px;
    --wSel: 15px;
    --wA: 22px;
  }
  .selPill{
    font-size:11px;
    border-radius:10px;
  }
}
</head>

<body>

<div class="header">
  <div class="header-inner">
    <div class="title"><span class="mxg">QUINIELA</span> <span class="mxr">AZTECA</span></div>
    <div class="week" id="weekTxt"></div>
    <div class="partidos" id="partidosTxt"></div>
    <div class="search">
      <input id="searchInput" placeholder="Busca aqu√≠‚Ä¶" autocomplete="off">
    </div>
    <div class="tableHeadRow">
      <div class="tableHeadGrid">
        <div class="thCell">#</div>
        <div class="thCell left">Nombre</div>
        <div class="thCell">1</div><div class="thCell">2</div><div class="thCell">3</div>
        <div class="thCell">4</div><div class="thCell">5</div><div class="thCell">6</div>
        <div class="thCell">7</div><div class="thCell">8</div><div class="thCell">9</div>
        <div class="thCell">A</div>
      </div>
    </div>
  </div>
</div>

<div class="wrap">
  <div class="tableBox" id="tableBox">
    <table id="tabla"><tbody></tbody></table>
    <div class="noResults" id="noResults" hidden>Sin coincidencias</div>
  </div>
</div>

<script>
const BASE="https://script.google.com/macros/s/AKfycbyGqoqBpUMbf34qt3cMBbvlsCuf-PXqK8Dvhv7Vzj4dgzNT9pBJ0-_UHkc-IvnPqZ1Y/exec";
const ENDPOINT=BASE+"?mode=clasif";
const CONFIG=BASE+"?mode=config";

let raw=[],resultados=[],marcadores=[],lastCfgSig="";
const $=id=>document.getElementById(id);

function norm(v){return String(v??"").toUpperCase()}
function sigCfg(cfg){
  return JSON.stringify({
    s:cfg.subtitulo,
    r:(cfg.resultados||[]).slice(0,9),
    m:(cfg.marcadores||[]).slice(0,9)
  });
}

function render(rows){
  const tb=$("tabla").querySelector("tbody");
  tb.innerHTML="";
  $("noResults").hidden=rows.length>0;

  rows.forEach(r=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td class="col-folio">${r.folio}</td>
      <td class="col-nombre">${r.nombre_show}</td>
      ${r.sels.map((s,i)=>`
        <td class="selCell"><span class="selPill">${s||"-"}</span></td>
      `).join("")}
      <td class="col-ac">${r.aciertos}</td>`;
    tb.appendChild(tr);
  });
}

function applyFilterLite(){
  const q=$("searchInput").value.trim().toLowerCase();
  if(!q){render(raw);return}
  const out=[];
  for(const r of raw){
    if(
      String(r.folio).includes(q)||
      r.nombre.includes(q)||
      String(r.telefono).includes(q)
    ){
      out.push(r);
      if(out.length>=450)break;
    }
  }
  render(out);
}

$("searchInput").addEventListener("input",applyFilterLite);
$("searchInput").addEventListener("keydown",e=>{
  if(e.key==="Enter"){e.preventDefault();$("searchInput").blur()}
});

async function load(){
  const cfgRes=await fetch(CONFIG,{cache:"no-store"}).then(r=>r.json());
  const cfg=cfgRes.cfg||{};
  const sig=sigCfg(cfg);
  if(sig===lastCfgSig)return;
  lastCfgSig=sig;

  $("weekTxt").textContent=cfg.subtitulo||"";
  resultados=(cfg.resultados||[]).slice(0,9);

  const res=await fetch(ENDPOINT,{cache:"no-store"}).then(r=>r.json());
  const d=res.data;
  const h=d.headers.map(x=>x.toLowerCase());
  const iF=h.indexOf("folio"),iN=h.indexOf("nombre"),iT=h.indexOf("telefono_envio"),iA=h.indexOf("aciertos");

  raw=d.rows.map(r=>{
    const n=String(r[iN]||"");
    return{
      folio:r[iF],
      telefono:r[iT]||"",
      nombre:n.toLowerCase(),
      nombre_show:n,
      sels:r.slice(iN+1,iA).slice(0,9),
      aciertos:r[iA]
    };
  });

  render(raw);
}

load();
setInterval(load,2000);
</script>
</body>
</html>


